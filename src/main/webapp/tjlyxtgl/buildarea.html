<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="css/jquery.monthpicker.css">
	<link rel="stylesheet" href="js/bootstrap/css/bootstrap.css">
		<style>
.chartcss {
	width: 600px;
	height: 500px;
}
</style>
</head>


<body>

	<div class="place">
		<span>位置：</span>
		<ul class="placeul">
			<li><a href="#">经济数据分析</a></li>
			<li><a href="#">单座商务楼宇年盘活面积分析</a></li>
		</ul>
	</div>
	<div class="rightinfo">
		<ul class="seachform">

			<li style="width: 400px;"><label>统计年</label> <select
				id="s_month">
					<option value="2015">2015</option>
					<option value="2016">2016</option>
					<option value="2017">2017</option>
					<option value="2018">2018</option>
					<option value="2019">2019</option>
					<option value="2020">2020</option>
					<option value="2021">2021</option>
					<option value="2022">2022</option>
					<option value="2023">2023</option>
					<option value="2023">2024</option>
					<option value="2023">2025</option>
			</select></li>
			<li style="width: 400px;"><label style="padding-left: 21px;">楼宇名称</label>
				<input id="s_buildname" type="text" class="scinput"
				style="width: 100px;" /> <input type="hidden" id="lyid"></input> <input
				type="button" class="btn btn-info" value="选择楼宇"
				onclick="showLYGrid()" style="margin-top:-10px;"></input></li>

			<li style="float: right;"><label>&nbsp;</label><input name=""
				type="button" class="btn btn-info" value="查询" onclick="search()" /></li>

		</ul>
		<div id="content">
			<ul>
				<div id="chart" class="chartcss"></div>
			</ul>
		</div>
	</div>
</body>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script src="js/echarts.common.min.js"></script>
<script src="js/jquery.monthpicker.js"></script>
<script>
	var now = new Date();
	var year = now.getFullYear();
	$("#s_month").find("option[value='" + year + "']").attr("selected", true);
	function search() {
		var mon = $("#s_month").val();
		if (mon == null || mon == "") {
			alert("请输入统计年！");
			return;
		}

		$.get("../month_count/build_charts", {
			countdate : $('#s_month').val(),
			buildid : $('#lyid').val()
		}, function(json) {
			var d = json;
			var months = d.months;
			var taxData = d.taxData;
			var taxStayData = d.taxStayData;
			var rentareaData = d.rentareaData;

			initChart(months, taxData, taxStayData, rentareaData);
		});
	}

	function initChart(months, taxData, taxStayData, rentareaData) {

		var myChart = echarts.init(document.getElementById("chart"));

		option = {
			title : {
				text : '单座商务楼宇年盘活面积分析'
			},
			tooltip : {
				trigger : 'axis'
			},
			legend : {
				data : [ '可招商面积' ]
			},
			toolbox : {
				show : true,
				feature : {
					mark : {
						show : true
					},
					dataView : {
						show : true,
						readOnly : false
					},
					magicType : {
						show : true,
						type : [ 'line', 'bar' ]
					},
					restore : {
						show : true
					},
					saveAsImage : {
						show : true
					}
				}
			},
			calculable : true,
			xAxis : [ {
				type : 'category',
				boundaryGap : false,
				data : months
			} ],
			yAxis : [ {
				type : 'value'
			} ],
			series : [ {
				name : '最高气温',
				type : 'line',
				data : rentareaData,
				markPoint : {
					data : [ {
						type : 'max',
						name : '最大值'
					}, {
						type : 'min',
						name : '最小值'
					} ]
				},
				markLine : {
					data : [ {
						type : 'average',
						name : '平均值'
					} ]
				}
			} ]
		};
		myChart.setOption(option);
	}

	function showLYGrid() {
		var iWidth = 1000;
		var iHeight = 600;
		var iTop = (window.screen.availHeight - 30 - iHeight) / 2;
		var iLeft = (window.screen.availWidth - 10 - iWidth) / 2;
		var win = window.open("lygrid.html", "弹出窗口", "width=" + iWidth
				+ ", height=" + iHeight + ",top=" + iTop + ",left=" + iLeft);
	}

	function transferValue(value) {
		var ly = value.split(",");
		$("#lyid").prop("value", ly[0]);
		$("#s_buildname").attr("value", ly[1]);
	}
</script>
</html>
